<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Jarvis Collecte Mobile</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: #f3f8f3;
    margin: 0;
    padding: 0;
  }

  header {
    background: #2e7d32;
    padding: 15px;
    text-align: center;
    color: white;
    font-size: 20px;
    font-weight: bold;
  }

  .container {
    padding: 15px;
  }

  label {
    font-weight: bold;
    display: block;
    margin-top: 12px;
    color: #1b5e20;
  }

  input, select {
    width: 100%;
    padding: 12px;
    margin-top: 5px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 16px;
  }

  button {
    width: 100%;
    padding: 15px;
    margin-top: 20px;
    background: #2e7d32;
    color: white;
    font-size: 18px;
    border: none;
    border-radius: 8px;
  }

  button:active {
    background: #1b5e20;
  }

  #result {
    background: white;
    margin-top: 20px;
    padding: 15px;
    border-radius: 8px;
    border-left: 5px solid #2e7d32;
  }
</style>

</head>
<body>

<header>Jarvis Collecte</header>

<div class="container">

  <label>Point de collecte</label>
  <input id="collecte" placeholder="ex : 01 Lidl Valence" />

  <label>Numéro de traçabilité</label>
  <input id="traca" placeholder="ex : 1701XXXXXXXX" />

  <label>Photo face avant</label>
  <input type="file" id="photo_face" accept="image/*" capture="environment">

  <label>Photo étiquette</label>
  <input type="file" id="photo_etiquette" accept="image/*" capture="environment">

  <button onclick="envoyer()">Créer fiche Jarvis</button>

  <div id="result"></div>

</div>

<script>
async function envoyer() {

  const collecte = document.getElementById('collecte').value.trim();
  const traca = document.getElementById('traca').value.trim();
  const face = document.getElementById('photo_face').files[0];
  const etiquette = document.getElementById('photo_etiquette').files[0];

  if (!collecte || !traca) {
    alert("Merci de renseigner le point de collecte et le numéro de traçabilité.");
    return;
  }

  const formData = new FormData();
  formData.append("collecte", collecte);
  formData.append("traca", traca);
  if (face) formData.append("photo_face", face);
  if (etiquette) formData.append("photo_etiquette", etiquette);

  const res = await fetch("https://jarvis-envie.onrender.com/collecte/creer", {
    method: "POST",
    body: formData,
  });

  const data = await res.json();

  document.getElementById("result").innerHTML =
    "<b>Résultat :</b><br><pre>" + JSON.stringify(data, null, 2) + "</pre>";
}
</script>

</body>
</html>
